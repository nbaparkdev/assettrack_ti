{% extends "base.html" %}

{% block content %}
<div class="space-y-8 fade-in">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4 border-b-2 border-black pb-4">
        <div>
            <h1 class="text-3xl font-bold text-black uppercase tracking-tighter leading-none">BASE_DE_ATIVOS</h1>
            <p class="font-mono text-xs text-gray-500 mt-1 uppercase tracking-widest">Sistema de Gestão de Inventário //
                V1.0</p>
        </div>
        <div class="flex items-center gap-3 w-full sm:w-auto">
            <!-- Mobile Scanner Button (Visible mostly on mobile but good for all) -->
            <a href="/assets/scanner"
                class="flex-1 sm:flex-none flex items-center justify-center gap-2 bg-white border-2 border-black text-black px-4 py-3 rounded-none text-sm font-bold uppercase tracking-widest hover:bg-gray-100 transition shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z">
                    </path>
                </svg>
                SCANNER
            </a>

            {% if user.role.value|lower in ['admin', 'gerente_ti'] %}
            <a href="/assets/new"
                class="hidden md:flex items-center gap-2 bg-black text-white px-6 py-3 rounded-none text-sm font-bold uppercase tracking-widest hover:bg-gray-800 transition shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)] hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,0.2)]">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                </svg>
                Novo Registro
            </a>
            {% endif %}
        </div>
    </div>

    <!-- Stats Grid (Data Blocks) -->
    <div class="grid grid-cols-2 lg:grid-cols-4 gap-0 border-2 border-black bg-black">
        <!-- Total -->
        <div class="bg-white p-4 border-r-2 border-b-2 lg:border-b-0 border-black group hover:bg-gray-50 transition">
            <h3 class="font-mono text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2">Total Unidades</h3>
            <div class="flex items-baseline gap-2">
                <span class="text-3xl font-bold tracking-tighter">{{ stats.total }}</span>
                <span class="font-mono text-[10px] text-gray-400">UNID.</span>
            </div>
        </div>
        <!-- Available -->
        <div
            class="bg-white p-4 border-r-2 lg:border-r-2 border-b-2 lg:border-b-0 border-black group hover:bg-gray-50 transition">
            <h3 class="font-mono text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2">Disponíveis</h3>
            <div class="flex items-baseline gap-2">
                <span class="text-3xl font-bold tracking-tighter text-green-600">{{ stats.available }}</span>
                <span class="font-mono text-[10px] text-gray-400">PRONTOS</span>
            </div>
        </div>
        <!-- In Use -->
        <div class="bg-white p-4 border-r-2 border-black group hover:bg-gray-50 transition">
            <h3 class="font-mono text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2">Em Uso</h3>
            <div class="flex items-baseline gap-2">
                <span class="text-3xl font-bold tracking-tighter text-blue-600">{{ stats.in_use }}</span>
                <span class="font-mono text-[10px] text-gray-400">EXTERNOS</span>
            </div>
        </div>
        <!-- Maintenance -->
        <div class="bg-white p-4 group hover:bg-gray-50 transition">
            <h3 class="font-mono text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2">Manutenção</h3>
            <div class="flex items-baseline gap-2">
                <span class="text-3xl font-bold tracking-tighter text-amber-500">{{ stats.maintenance }}</span>
                <span class="font-mono text-[10px] text-gray-400">OFICINA</span>
            </div>
        </div>
    </div>

    <!-- Table Container -->
    <div class="border-2 border-gray-200 bg-white">
        <div class="overflow-x-auto">
            <table class="min-w-full text-left">
                <thead class="bg-gray-50 border-b-2 border-black">
                    <tr>
                        <th class="px-6 py-4 text-xs font-bold text-black uppercase tracking-wider font-mono">ID Ativo /
                            Modelo</th>
                        <th class="px-6 py-4 text-xs font-bold text-black uppercase tracking-wider font-mono">Serial S/N
                        </th>
                        <th class="px-6 py-4 text-xs font-bold text-black uppercase tracking-wider font-mono">Status
                        </th>
                        <th class="px-6 py-4 text-xs font-bold text-black uppercase tracking-wider font-mono">
                            Usuário/Local</th>
                        <th
                            class="px-6 py-4 text-right text-xs font-bold text-black uppercase tracking-wider font-mono">
                            Ações</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                    {% for asset in assets %}
                    <tr class="hover:bg-gray-50 transition group cursor-pointer"
                        onclick="window.location='/assets/{{ asset.id }}'">
                        <td class="px-6 py-4">
                            <div class="flex flex-col">
                                <span class="font-bold text-sm text-gray-900 group-hover:text-amber-600 transition">{{
                                    asset.nome }}</span>
                                <span class="text-xs text-gray-500 font-mono">{{ asset.modelo }}</span>
                            </div>
                        </td>
                        <td class="px-6 py-4">
                            <span
                                class="font-mono text-xs text-gray-600 bg-gray-100 px-2 py-1 border border-gray-200">{{
                                asset.serial_number }}</span>
                        </td>
                        <td class="px-6 py-4">
                            {% if asset.status.value == 'disponivel' %}
                            <span
                                class="inline-flex items-center px-2 py-0.5 rounded-none text-[10px] font-bold uppercase tracking-widest bg-green-100 text-green-800 border border-green-200">
                                DISPONIVEL
                            </span>
                            {% elif asset.status.value == 'em_uso' %}
                            <span
                                class="inline-flex items-center px-2 py-0.5 rounded-none text-[10px] font-bold uppercase tracking-widest bg-blue-100 text-blue-800 border border-blue-200">
                                EM_USO
                            </span>
                            {% elif asset.status.value == 'manutencao' %}
                            <span
                                class="inline-flex items-center px-2 py-0.5 rounded-none text-[10px] font-bold uppercase tracking-widest bg-amber-100 text-amber-800 border border-amber-200">
                                MANUTENCAO
                            </span>
                            {% else %}
                            <span
                                class="inline-flex items-center px-2 py-0.5 rounded-none text-[10px] font-bold uppercase tracking-widest bg-gray-100 text-gray-800 border border-gray-200">
                                {{ asset.status.value }}
                            </span>
                            {% endif %}
                        </td>
                        <td class="px-6 py-4">
                            {% if asset.current_user %}
                            <div class="flex items-center gap-2">
                                <span class="font-mono text-xs font-bold text-gray-900">{{ asset.current_user.nome
                                    }}</span>
                            </div>
                            {% elif asset.current_armazenamento %}
                            <span class="font-mono text-xs text-gray-500">{{ asset.current_armazenamento.nome }}</span>
                            {% else %}
                            <span class="text-gray-300 font-mono text-xs">-</span>
                            {% endif %}
                        </td>
                        <td class="px-6 py-4 text-right" onclick="event.stopPropagation()">
                            <div class="flex items-center justify-end gap-3">
                                <a href="/assets/{{ asset.id }}"
                                    class="text-xs font-bold uppercase text-black hover:underline tracking-wider">
                                    DETALHES
                                </a>
                                <span class="text-gray-300">|</span>
                                <a href="/assets/qrcode/{{ asset.id }}" target="_blank"
                                    class="text-gray-400 hover:text-black">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z">
                                        </path>
                                    </svg>
                                </a>
                            </div>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="5" class="px-6 py-12 text-center">
                            <p class="font-mono text-gray-400 mb-2">BASE_DADOS_VAZIA</p>
                            {% if user.role.value|lower in ['admin', 'gerente_ti'] %}
                            <a href="/assets/new"
                                class="inline-block text-xs font-bold uppercase border-b-2 border-black pb-0.5 hover:pb-1 transition-all">Inicializar
                                Primeiro Registro</a>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}